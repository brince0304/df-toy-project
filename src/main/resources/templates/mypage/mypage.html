<!DOCTYPE html>
<html lang="ko">
<head>
    <link href="/Login/assets/css/main.css" rel="stylesheet"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link th:href="@{/Login/assets/css/bootstrap.css}" rel="stylesheet"/>
    <meta charset="UTF-8">
    <script src="https://kit.fontawesome.com/1d4d31d2f3.js" crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link th:href="@{/Login/assets/css/login-register.css}" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
    <link rel="stylesheet" href="/css/util.css">

    <link rel="stylesheet" href="/header/fonts/icomoon/style.css">

    <link rel="stylesheet" href="/header/css/owl.carousel.min.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/header/css/bootstrap.min.css">
    <!-- Style -->
    <link rel="stylesheet" href="/header/css/style.css">

    <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.3.1/css/all.css'>
    <title>던파모아온오프</title>
    <style>
        .getMoreBtn {
            display: inline-flex;
            padding-right: 30%;
            padding-left: 30%;
            scale: 1.3;
            cursor: pointer;
        }

        .myPage-character {
            background-image: url("/images/icon_char/bg_char.jpeg");
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
            float: left;
            width: 25px;
            height: 25px;
            overflow: hidden;
            position: relative;
            display: inline-block;
            border-radius: 50%;
            border: 1.5px solid #898989;
            margin-left: 5px;
        }

        .myPage-character .f-mage {
            position: absolute;
            left: -980%;
            right: -1010%;
            top: -1050%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }


        .myPage-character .default {
            position: absolute;
            left: -980%;
            right: -1010%;
            top: -1030%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .m-gunner {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -700%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .f-gunner {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -850%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .m-fighter {
            position: absolute;
            left: -1000%;
            right: -1030%;
            top: -850%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .f-thief {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -870%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .f-fighter {
            position: absolute;
            left: -980%;
            right: -990%;
            top: -960%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }


        .myPage-character .m-warrior {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -900%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .f-warrior {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -930%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .f-priest {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -930%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .m-priest {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -760%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .m-lancer {
            position: absolute;
            left: -1000%;
            right: -1050%;
            top: -840%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .myPage-character .m-gunwarrior {
            position: absolute;
            left: -1000%;
            right: -1010%;
            top: -810%;
            bottom: -1020%;
            margin: auto;
            min-height: 100%;
            min-width: 100%;
        }

        .boardIcon {
            width: 25px;
            aspect-ratio: auto 25 / 25;
            height: 25px;
            overflow-clip-margin: content-box;
            overflow: clip;
            vertical-align: middle;
        }

        .userLogLink {
            text-decoration-line: none;
            color: black;
        }
    </style>
</head>
<body>
<header id="header">
    헤더
</header>
<div class="container" style="margin-top : 92px">
    <div class="card mt-5 border-5 pt-2 active pb-0 px-3">
        <div class="card-body ">
            <div class="row">
                <div class="col-12 ">
                    <h4 class="card-title "><b th:text="${user.nickname} +' 님 환영합니다!'">Program Title</b></h4>

                </div>
                <div class="col">
                    <h6 class="card-subtitle mb-2 text-muted">
                        <p class="card-text text-muted small ">
                            <img src="https://img.icons8.com/metro/26/000000/star.png" class="mr-1 " width="19"
                                 height="19" id="star"> <span class="vl mr-2 ml-0"></span>

                            <span class="font-weight-bold">아이디 : </span><span
                                th:text="${user.userId}+' 이메일 : '+${user.email}"></span></p>
                    </h6>
                </div>
            </div>

        </div>

        <div class="card-footer bg-white px-0 ">
            <div class="row">

                <div class=" col-md-auto ">
                    <a class="btn btn-outlined btn-black text-muted bg-transparent"
                       data-wow-delay="0.7s" data-toggle="modal" href="#"
                       data-target="#detailModifyModal"><img src="https://img.icons8.com/ios/50/000000/settings.png"
                                                             width="19" height="19"> <small>정보 수정</small></a>

                    <i class="mdi mdi-settings-outline"></i>


                    <a href="#" class="btn btn-outlined btn-black text-muted" data-toggle="modal"
                       data-target="#charSearchModal">
                        <img src="https://img.icons8.com/metro/26/000000/link.png" width="20" height="20">
                        <small>캐릭터 등록</small> </a>


                    <a style="cursor:pointer" class="btn btn-outlined btn-black text-muted "
                       onclick="getUserBoardLogs()"
                       data-toggle="modal"
                       data-target="#userLogModal"><small><i class="fa fa-bell-o" style="color:darkred ;scale:1.2"
                                                             aria-hidden="true" th:if="${uncheckedLogCount!=0}"></i>
                        <i class="fa fa-bell-o" style="scale:1.2" aria-hidden="true"
                           th:if="${uncheckedLogCount==0}"></i> 활동 내역</small></a>
                </div>

                <div class="col-md-auto ">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a data-toggle="modal"
                                                        data-target="#iconSelectModal" href="#" class="
                         btn btn-outlined btn-black text-muted"> <img
                                th:src="${user.profileIconPath}" src=""
                                alt="DP" class="  rounded-circle img-fluid " width="20" height="20"> <small>프로필 아이콘
                            변경</small> </a>
                        </li>
                        <li class="list-inline-item"><a data-toggle="modal"
                                                        data-target="#charSearchModalForAdventure" href="#" class="
                         btn btn-outlined btn-black text-muted"> <small>모험단 등록</small> </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <br>
    <br>
    <div class="row">
        <div class="col-12">
            <div class="card card-margin">
                <div class="card-body">
                    <div class="row search-body">
                        <div class="col-lg-12">
                            <div class="search-result">
                                <div class="result-body">
                                    <div class="table-responsive" style="border:none;">
                                        <div th:if="${user.characters.isEmpty() && user.adventureCharacters.isEmpty()}">
                                            <div style="text-align: center; margin-top: 50px; margin-bottom: 50px">
                                                <i class="fa-solid fa-skull-crossbones" style="font-size: 60px"></i>
                                                <div style="font-size: 20px; font-weight: 500; color: #999999; margin-top: 20px">
                                                    캐릭터가 존재하지 않습니다.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="container">
                                            <div class="row charThumb">
                                                <div th:if="${user.adventureCharacters.size()>0}" th:each="char : ${user.adventureCharacters}"
                                                     class="col-12 col-sm-6 col-lg-3">
                                                    <a style="text-decoration-line: none;text-decoration-color: black"
                                                       th:href="@{/characters/detail(characterId=${char.characterId},serverId=${char.serverId})}">
                                                        <div class="single_advisor_profile wow fadeInUp characterCard"
                                                             data-wow-delay="0.2s"
                                                             style="background-image: url('/images/icon_char/bg_char.jpeg') ;   background-repeat: no-repeat;   background-position: center;
                                                            background-size: cover;">
                                                            <div style="">
                                                                <!-- Team Thumb-->
                                                                <span class="badge bg-light text-dark" style="float:left">
                                                            <img class="icon-fame"
                                                                 th:src="@{/images/icon_char/icon_status_fame.png}"
                                                                 src="" alt="fame"
                                                                 style=""> <small
                                                                        style=" display:inline; color: #d39e00"
                                                                        th:text="${char.adventureFame}"></small> </span>
                                                                <img class="badge bg-light text-dark" type="button"
                                                                      th:data-id="${char.characterId}"
                                                                      th:data-server="${char.serverId}"
                                                                      style="display:inline ; float:right; " src="/images/icon_char/mohum.png"></div>
                                                            <div class="advisor_thumb">
                                                                <img th:src="${char.characterImageUrl}"
                                                                     src="" style="scale:1.7" alt="">
                                                                <!-- Social Info-->
                                                            </div>
                                                            <!-- Team Details-->
                                                            <div class="single_advisor_details_info"
                                                                 style="text-align: left">
                                                                <h4 style="color: #898989;"
                                                                    th:text="${char.getServerName(char.serverId)}"
                                                                    id="charServerId"></h4>
                                                                <h6 th:text="${char.characterName}">
                                                                    Samantha Sarah</h6>
                                                                <p style="color: #898989" th:text="${char.jobGrowName}"></p>
                                                                <p class="designation" style="color: #898989"
                                                                   th:text="${char.adventureName}">
                                                                </p>
                                                                <p style="display:inline"
                                                                   th:text=" 'Lv.'+${char.level}"></p>
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                                <!-- Single Advisor-->
                                                <div th:each="char : ${user.characters}"
                                                     class="col-12 col-sm-6 col-lg-3">
                                                    <a style="text-decoration-line: none;text-decoration-color: black"
                                                       th:href="@{/characters/detail(characterId=${char.characterId},serverId=${char.serverId})}">
                                                    <div class="single_advisor_profile wow fadeInUp characterCard"
                                                         data-wow-delay="0.2s"
                                                         style="background-image: url('/images/icon_char/bg_char.jpeg') ;   background-repeat: no-repeat;   background-position: center;
                                                            background-size: cover;">
                                                        <div style="">
                                                            <!-- Team Thumb-->
                                                            <span class="badge bg-light text-dark" style="float:left">
                                                            <img class="icon-fame"
                                                                 th:src="@{/images/icon_char/icon_status_fame.png}"
                                                                 src="" alt="fame"
                                                                 style=""> <small
                                                                    style=" display:inline; color: #d39e00"
                                                                    th:text="${char.adventureFame}"></small> </span>
                                                            <span class="badge bg-light text-dark" type="button"
                                                                  th:data-id="${char.characterId}"
                                                                  th:data-server="${char.serverId}"
                                                                  onclick="deleteCharacter(this.getAttribute('data-id'), this.getAttribute('data-server'))"
                                                                  style="display:inline ; float:right; ">삭제</span></div>
                                                        <div class="advisor_thumb">
                                                            <img th:src="${char.characterImageUrl}"
                                                                 src="" style="scale:1.7" alt="">
                                                            <!-- Social Info-->
                                                        </div>
                                                        <!-- Team Details-->
                                                        <div class="single_advisor_details_info"
                                                             style="text-align: left">
                                                            <h4 style="color: #898989;"
                                                                th:text="${char.getServerName(char.serverId)}"
                                                                id="charServerId"></h4>
                                                            <h6 th:text="${char.characterName}">
                                                                Samantha Sarah</h6>
                                                            <p style="color: #898989" th:text="${char.jobGrowName}"></p>
                                                            <p class="designation" style="color: #898989"
                                                               th:text="${char.adventureName}">
                                                            </p>
                                                            <p style="display:inline"
                                                               th:text=" 'Lv.'+${char.level}"></p>
                                                        </div>
                                                    </div>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="charSearchModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2"
         style="margin-left:2%"
         aria-hidden="true">
        <div class="modal-dialog" style="max-width:500px" role="document">
            <div class="modal-content" style="    border: 1px solid rgba(0,0,0,.2);">
                <div class="modal-header" style="padding: 5px;">
                    <div class="input-group" style="z-index: 1;">
                        <div class="input-group">
                            <select name="serverId" id="serverId">
                                <option value="all">전체</option>
                                <option value="adventure">모험단</option>
                                <option value="cain">카인</option>
                                <option value="diregie">디레지에</option>
                                <option value="siroco">시로코</option>
                                <option value="prey">프레이</option>
                                <option value="casillas">카시야스</option>
                                <option value="hilder">힐더</option>
                                <option value="anton">안톤</option>
                                <option value="bakal">바칼</option>
                            </select>
                            <input type="text" placeholder="입력" class="form-control" id="characterName"
                                   name="characterName">
                            <button type="button" class="btn btn-info" style="height:39px;" id="btn-search" href="#"
                                    onclick="searchCharacter()">검색
                            </button>
                        </div>
                    </div>
                </div>
                <div id="searchBody" class="modal-body" style="min-height: 300px; max-height: 500px; overflow: auto;">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="charSearchModalForAdventure" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2"
         style="margin-left:2%"
         aria-hidden="true">
        <div class="modal-dialog" style="max-width:500px" role="document">
            <div class="modal-content" style="    border: 1px solid rgba(0,0,0,.2);">
                <div class="modal-header" style="padding: 5px;">
                    <div class="input-group" style="z-index: 1;">
                        <div class="input-group">
                            <select name="serverId" id="serverIdAdventure">
                                <option value="all">전체</option>
                                <option value="adventure">모험단</option>
                                <option value="cain">카인</option>
                                <option value="diregie">디레지에</option>
                                <option value="siroco">시로코</option>
                                <option value="prey">프레이</option>
                                <option value="casillas">카시야스</option>
                                <option value="hilder">힐더</option>
                                <option value="anton">안톤</option>
                                <option value="bakal">바칼</option>
                            </select>
                            <input type="text" placeholder="입력" class="form-control" id="characterNameAdventure"
                                   name="characterName">
                            <button type="button" class="btn btn-info" style="height:39px;" id="btn-search-adventure" href="#"
                                    onclick="searchCharacterForAddAdventure()">검색
                            </button>
                        </div>
                    </div>
                </div>
                <div id="searchBodyForAdventure" class="modal-body" style="min-height: 300px; max-height: 500px; overflow: auto;">
                    <h4 style="text-align: center;">등록을 원하는 100레벨 이상의 대표캐릭터를 검색해주세요.</h4>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade notification" id="userLogModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2"
         style="margin-left:2%"
         aria-hidden="true">
        <div class="modal-dialog" style="max-width:500px" role="document">
            <div class="modal-content" style="    border: 1px solid rgba(0,0,0,.2); padding:0">
                <div class="modal-header" style="padding: 5px;">
                    <h5 class="modal-title" id="exampleModalLabel2" style="
    font-size: 16px;
    margin-left: 12px;">활동 내역</h5>
                </div>
                <div class="row" style="margin-left:0; margin-right:0;">
                    <div class="col-md-12">
                        <nav>
                            <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                                <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab"
                                   href="#nav-board"
                                   role="tab" aria-controls="nav-home" aria-selected="true">게시글</a>
                                <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-comment"
                                   role="tab" aria-controls="nav-profile" aria-selected="false"
                                   onclick="getUserCommentLogs()">댓글</a>
                                <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-log"
                                   role="tab" aria-controls="nav-contact" aria-selected="false" onclick="getUserLogs()">알람</a>
                            </div>
                        </nav>
                    </div>
                    <div class="tab-content modal-body" id="nav-tabContent">
                        <div class="tab-pane fade show active" id="nav-board" role="tabpanel"
                             aria-labelledby="nav-home-tab">
                            <div style="">
                                <a data-toggle="dropdown"
                                   class="align-items-center dropdown-link " aria-haspopup="true"
                                   aria-expanded="false" data-offset="-70, 20"
                                   style="text-decoration-line: none ;color: black; cursor:pointer">
                                    <div style="padding-left:10px">
                                        <span id="sortByBoard"><i class="fa fa-calendar-o"></i> 최신순</span>
                                        <span class="arrow icon-keyboard_arrow_down"></span></div>
                                </a>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="z-index: 1000">
                                    <a class="dropdown-item" onclick="getUserBoardLogs('like')"> <span
                                            class="fa fa-heart-o"></span> 좋아요순</a>
                                    <a class="dropdown-item" onclick="getUserBoardLogs('view')"><span
                                            class="fa fa-eye"></span> 조회수순</a>
                                    <a class="dropdown-item" onclick="getUserBoardLogs('commentCount')"><span
                                            class="fa fa-comments-o"></span> 댓글갯수순</a>
                                    <a class="dropdown-item" onclick="getUserBoardLogs('date')"><span
                                            class="fa fa-calendar-o"></span> 최신순</a>
                                </div>
                            </div>
                            <div id="boardLog"></div>
                            <div style="display: inline-flex; margin-left:10px">
                                <div id="prevBoardssBtn" style=" cursor:pointer" onclick="getUserBoardLogs(-1)"
                                     disabled>
                                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                                </div>
                                <span class="text-black" id="boardPage"
                                      style="margin-left:10px ; margin-right:10px">0</span>
                                <div id="nextBoardsBtn" style="cursor:pointer" onclick="getUserBoardLogs(1)" disabled>
                                    <i class="fa fa-arrow-right" style="" aria-hidden="true"></i>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="nav-comment" role="tabpanel"
                             aria-labelledby="nav-home-tab">
                            <div style="">
                                <a data-toggle="dropdown"
                                   class="align-items-center dropdown-link " aria-haspopup="true"
                                   aria-expanded="false" data-offset="-70, 20"
                                   style="text-decoration-line: none ;color: black; cursor:pointer">
                                    <div style="padding-left:10px">
                                        <span id="sortByComment"><i class="fa fa-calendar-o"></i> 최신순</span>
                                        <span class="arrow icon-keyboard_arrow_down"></span></div>
                                </a>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="z-index: 1000">
                                    <a class="dropdown-item" onclick="getUserCommentLogs('like')"> <span
                                            class="fa fa-heart-o"></span> 좋아요순</a>
                                    <a class="dropdown-item" onclick="getUserCommentLogs('date')"><span
                                            class="fa fa-calendar-o"></span> 최신순</a>
                                </div>
                            </div>
                            <div id="commentLog">
                            </div>
                            <div style="display: inline-flex; margin-left:10px">
                                <div id="prevCommentsBtn" style=" cursor:pointer" onclick="getUserCommentLogs(-1)"
                                     disabled>
                                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                                </div>
                                <span class="text-black" id="commentPage"
                                      style="margin-left:10px ; margin-right:10px">0</span>
                                <div id="nextCommentsBtn" style="cursor:pointer" onclick="getUserCommentLogs(1)"
                                     disabled>
                                    <i class="fa fa-arrow-right" style="" aria-hidden="true"></i>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="nav-log" role="tabpanel"
                             aria-labelledby="nav-home-tab">
                            <div style="">

                            </div>
                            <div id="notification">
                            </div>
                            <div style="display: inline-flex; margin-left:10px">
                                <div id="prevUserLogBtn" style=" cursor:pointer" onclick="getUserLogs(-1)" disabled>
                                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                                </div>
                                <span class="text-black" id="userLogPage"
                                      style="margin-left:10px ; margin-right:10px">0</span>
                                <div id="nextUserLogBtn" style="cursor:pointer" onclick="getUserLogs(1)" disabled>
                                    <i class="fa fa-arrow-right" style="" aria-hidden="true"></i>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">

                            <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="detailModifyModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         style="margin-left:2%"
         aria-hidden="true">
        <div class="modal-dialog" style="max-width:500px" role="document">
            <div class="modal-content" style="    border: 1px solid rgba(0,0,0,.2);">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel0">정보를 수정합니다!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="position: relative;
    flex: 1 1 auto;
    padding: 1rem;">
                    <label for="nicknameUpdate" style="color: #898989;">닉네임</label>
                    <div class="input-group mb-3" id="nicknameUpdateForm">
                        <input type="text" class="form-control" id="nicknameUpdate" placeholder="새 닉네임을 입력해주세요.">
                        <button class="btn btn-outline-secondary" type="button" id="nicknameUpdateBtn"
                                onclick="updateNickname()">변경
                        </button>
                        <div class="valid-feedback" id="nicknameUpdateVal">사용 가능한 닉네임 입니다.</div>
                        <div class="invalid-feedback" id="nicknameUpdateNonVal">중복된 닉네임이 존재합니다.</div>
                    </div>
                    <label for="passwordUpdate" style="color: #898989;">비밀번호</label>
                    <div class="input-group mb-3" id="passwordUpdateForm">
                        <input type="text" class="form-control" id="passwordUpdate" placeholder="새로운 비밀번호를 입력해주세요.">
                    </div>
                    <label for="passwordCheckUpdate" style="color: #898989;">비밀번호 확인</label>
                    <div class="input-group mb-3" id="passwordUpdateForm">
                        <input type="text" class="form-control" id="passwordCheckUpdate" placeholder="비밀번호를 재입력 해주세요.">
                        <button class="btn btn-outline-secondary" type="button" id="passwordUpdateBtn"
                                onclick="updatePassword()">변경
                        </button>
                        <div class="valid-feedback" id="passwordUpdateVal">사용 가능한 비밀번호 입니다.</div>
                        <div class="invalid-feedback" id="passwordUpdateNonVal">비밀번호가 일치하지 않습니다.</div>
                    </div>
                    <label for="emailUpdate" style="color: #898989;">이메일</label>
                    <div class="input-group mb-3" id="emailUpdateForm">
                        <input type="text" class="form-control" id="emailUpdate" placeholder="새 이메일을 입력해주세요.">
                        <button class="btn btn-outline-secondary" type="button" id="emailUpdateBtn"
                                onclick="updateEmail()">변경
                        </button>
                        <div class="valid-feedback" id="emailUpdateVal">사용 가능한 이메일 입니다.</div>
                        <div class="invalid-feedback" id="emailUpdateNonVal">중복된 이메일이 존재합니다.</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="iconSelectModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         style="margin-left:2%"
         aria-hidden="true">
        <div class="modal-dialog" style="max-width:500px" role="document">
            <div class="modal-content" style="    border: 1px solid rgba(0,0,0,.2);">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel1">환영합니다!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="position: relative;
    flex: 1 1 auto;
    padding: 1rem;">
                    <span style="color: #898989;"> 변경을 원하는 아이콘을 선택해주세요!</span>
                    <ul class="ub p-0 mt-3 mb-3" style="    margin: 0;
    display: inline-table; box-sizing: border-box;">
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(0)"> <img
                                    th:src="@{/images/icon_char/icon_char_0.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(1)"> <img
                                    th:src="@{/images/icon_char/icon_char_1.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(2)"> <img
                                    th:src="@{/images/icon_char/icon_char_2.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(3)"> <img
                                    th:src="@{/images/icon_char/icon_char_3.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(4)"> <img
                                    th:src="@{/images/icon_char/icon_char_4.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(5)"> <img
                                    th:src="@{/images/icon_char/icon_char_5.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(6)"> <img
                                    th:src="@{/images/icon_char/icon_char_6.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(7)"> <img
                                    th:src="@{/images/icon_char/icon_char_7.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(8)"> <img
                                    th:src="@{/images/icon_char/icon_char_8.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(9)"> <img
                                    th:src="@{/images/icon_char/icon_char_9.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(10)"> <img
                                    th:src="@{/images/icon_char/icon_char_10.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(11)"> <img
                                    th:src="@{/images/icon_char/icon_char_11.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(12)"> <img
                                    th:src="@{/images/icon_char/icon_char_12.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(13)"> <img
                                    th:src="@{/images/icon_char/icon_char_13.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(14)"> <img
                                    th:src="@{/images/icon_char/icon_char_14.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>
                        <li>
                            <a class="userIcon btn-outlined btn-black text-muted" href="#"
                               onclick="changeProfileIcon(15)"> <img
                                    th:src="@{/images/icon_char/icon_char_15.png}" src=""
                                    alt="DP" class="  rounded-circle img-fluid " width="28" height="28"></a>
                        </li>


                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

</div>

<footer id="footer">
    푸터
</footer>
<script src="/header/js/jquery.sticky.js"></script>
<script src="/header/js/main.js"></script>
<script src="https://code.jquery.com/jquery-3.6.1.js"></script>
<!-- Popper JS -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js'></script>
<!-- Bootstrap JS -->
<script src='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js'></script>
</body>
<script>
    let emailCheck = false;
    let nicknameCheck = false;
    let passwordBooleanCheck = false;

    function changeProfileIcon(number) {
        if (confirm("아이콘을 변경하시겠습니까?")) {
            const iconName = "icon_char_" + number + ".png";
            $.ajax({
                url: "/users?profileIcon=" + iconName,
                type: "PUT",
                data: {
                    iconNumber: number
                },
                success: function (data) {

                    alert("아이콘 변경이 완료되었습니다.");
                    location.reload();
                },
                error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            });
        } else {
            return;
        }
    }

    // Mobile Navigation
    if ($('#nav-menu-container').length) {
        var $mobile_nav = $('#nav-menu-container').clone().prop({
            id: 'mobile-nav'
        });
        $mobile_nav.find('> ul').attr({
            'class': '',
            'id': ''
        });
        $('body').append($mobile_nav);
        $('body').prepend('<button type="button" id="mobile-nav-toggle"><i class="fa fa-bars"></i></button>');
        $('body').append('<div id="mobile-body-overly"></div>');
        $('#mobile-nav').find('.menu-has-children').prepend('<i class="fa fa-chevron-down"></i>');

        $(document).on('click', '.menu-has-children i', function (e) {
            $(this).next().toggleClass('menu-item-active');
            $(this).nextAll('ul').eq(0).slideToggle();
            $(this).toggleClass("fa-chevron-up fa-chevron-down");
        });

        $(document).on('click', '#mobile-nav-toggle', function (e) {
            $('body').toggleClass('mobile-nav-active');
            $('#mobile-nav-toggle i').toggleClass('fa-times fa-bars');
            $('#mobile-body-overly').toggle();
        });

        $(document).click(function (e) {
            var container = $("#mobile-nav, #mobile-nav-toggle");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                if ($('body').hasClass('mobile-nav-active')) {
                    $('body').removeClass('mobile-nav-active');
                    $('#mobile-nav-toggle i').toggleClass('fa-times fa-bars');
                    $('#mobile-body-overly').fadeOut();
                }
            }
        });
    } else if ($("#mobile-nav, #mobile-nav-toggle").length) {
        $("#mobile-nav, #mobile-nav-toggle").hide();
    }

    // Smooth scroll for the menu and links with .scrollto classes
    $('.nav-menu a, #mobile-nav a, .scrollto').on('click', function () {
        if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
            var target = $(this.hash);
            if (target.length) {
                var top_space = 0;

                if ($('#header').length) {
                    top_space = $('#header').outerHeight();

                    if (!$('#header').hasClass('header-fixed')) {
                        top_space = top_space - 20;
                    }
                }

                $('html, body').animate({
                    scrollTop: target.offset().top - top_space
                }, 1500, 'easeInOutExpo');

                if ($(this).parents('.nav-menu').length) {
                    $('.nav-menu .menu-active').removeClass('menu-active');
                    $(this).closest('li').addClass('menu-active');
                }

                if ($('body').hasClass('mobile-nav-active')) {
                    $('body').removeClass('mobile-nav-active');
                    $('#mobile-nav-toggle i').toggleClass('fa-times fa-bars');
                    $('#mobile-body-overly').fadeOut();
                }
                return false;
            }
        }
    });

    $('#nicknameUpdate').blur(function () {
        const nickname = $('#nicknameUpdate').val();
        $.ajax({
            url: "/users/check?nickname=" + nickname,
            type: "GET",
            success: function (data) {
                if (data === "true") {
                    $('#nicknameUpdateForm').addClass('was-validated');
                    $('#nicknameUpdate').removeClass("is-invalid");
                    $('#nicknameUpdate').addClass("is-valid");
                    $('#nicknameUpdateNonVal').hide();
                    $('#nicknameUpdateVal').show();
                    nicknameCheck = true;
                } else if (data === "false") {
                    $('#nicknameUpdateForm').removeClass('was-validated');
                    $('#nicknameUpdate').removeClass("is-valid");
                    $('#nicknameUpdate').addClass("is-invalid");
                    $('#nicknameUpdateVal').hide();
                    $('#nicknameUpdateNonVal').show();
                    nicknameCheck = false;
                }

            }, error: function (request, status, error) {
                alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
            }
        });
    });

    $('#emailUpdate').blur(function () {
        const email = $('#emailUpdate').val();
        $.ajax({
            url: "/users/check?email=" + email,
            type: "GET",
            success: function (data) {
                if (data === "true") {
                    $('#emailUpdateForm').addClass('was-validated');
                    $('#emailUpdate').removeClass("is-invalid");
                    $('#emailUpdate').addClass("is-valid");
                    $('#emailUpdateNonVal').hide();
                    $('#emailUpdateVal').show();
                    emailCheck = true;
                } else if (data === "false") {
                    $('#emailUpdateForm').removeClass('was-validated');
                    $('#emailUpdate').removeClass("is-valid");
                    $('#emailUpdate').addClass("is-invalid");
                    $('#emailUpdateVal').hide();
                    $('#emailUpdateNonVal').show();
                    emailCheck = false;
                }

            }, error: function (request, status, error) {
                alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
            }
        });
    });

    $('#passwordCheckUpdate').blur(function () {
        const password = $('#passwordUpdate').val();
        let passwordCheck = $('#passwordCheckUpdate').val();

        if (password !== passwordCheck) {
            $('#passwordCheckUpdateForm').removeClass('was-validated');
            $('#passwordCheckUpdate').removeClass("is-valid");
            $('#passwordCheckUpdate').addClass("is-invalid");
            $('#passwordCheckUpdateVal').hide();
            $('#passwordCheckUpdateNonVal').show();
            $('#passwordUpdate').removeClass("is-valid");
            $('#passwordUpdate').addClass("is-invalid");
            passwordBooleanCheck = false;
        } else {
            $('#passwordCheckUpdateForm').addClass('was-validated');
            $('#passwordCheckUpdate').addClass("is-valid");
            $('#passwordCheckUpdate').removeClass("is-invalid");
            $('#passwordUpdate').addClass("is-valid");
            $('#passwordUpdate').removeClass("is-invalid");
            $('#passwordCheckUpdateVal').show();
            $('#passwordCheckUpdateNonVal').hide();
            passwordBooleanCheck = true;
        }
    });

    $('#passwordUpdate').blur(function () {
        const password = $('#passwordUpdate').val();
        const passwordCheck = $('#passwordCheckUpdate').val();

        if (password !== passwordCheck) {
            $('#passwordCheckUpdateForm').removeClass('was-validated');
            $('#passwordCheckUpdate').removeClass("is-valid");
            $('#passwordCheckUpdate').addClass("is-invalid");
            $('#passwordCheckUpdateVal').hide();
            $('#passwordCheckUpdateNonVal').show();
            $('#passwordUpdate').removeClass("is-valid");
            $('#passwordUpdate').addClass("is-invalid");
            passwordBooleanCheck = false;
        } else {
            $('#passwordCheckUpdateForm').addClass('was-validated');
            $('#passwordCheckUpdate').addClass("is-valid");
            $('#passwordCheckUpdate').removeClass("is-invalid");
            $('#passwordUpdate').addClass("is-valid");
            $('#passwordUpdate').removeClass("is-invalid");
            $('#passwordCheckUpdateVal').show();
            $('#passwordCheckUpdateNonVal').hide();
            passwordBooleanCheck = true;
        }
    });

    function updatePassword() {
        const password = $('#passwordUpdate').val();
        if (!passwordBooleanCheck) {
            alert("비밀번호가 일치하지 않습니다.");
            return;
        } else if (confirm("비밀번호를 변경하시겠습니까?")) {
            $.ajax({
                url: "/users?password=" + password,
                type: "PUT",
                success: function (data) {
                    alert("비밀번호가 변경되었습니다.");
                    $('#passwordUpdate').val("");
                    $('#passwordCheckUpdate').val("");
                    $('#passwordCheckUpdateForm').removeClass('was-validated');
                    $('#passwordCheckUpdate').removeClass("is-valid");
                    passwordBooleanCheck = false;
                    location.reload();
                }, error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            });
        }

    }

    function updateEmail() {
        const email = $('#emailUpdate').val();
        if (!emailCheck) {
            alert("중복된 이메일입니다.");
            return;
        } else if (confirm("이메일을 변경하시겠습니까?")) {
            $.ajax({
                url: "/users?email=" + email,
                type: "PUT",
                success: function (data) {
                    alert("이메일이 변경되었습니다.");
                    $('#emailUpdate').val("");
                    $('#emailUpdateForm').removeClass('was-validated');
                    $('#emailUpdate').removeClass("is-valid");
                    emailCheck = false;
                    location.reload();

                }, error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            });
        }

    }

    function updateNickname() {
        const nickname = $('#nicknameUpdate').val();
        if (!nicknameCheck) {
            alert("중복된 닉네임입니다.");
            return;
        } else if (confirm("닉네임을 변경하시겠습니까?")) {
            $.ajax({
                url: "/users?nickname=" + nickname,
                type: "PUT",
                success: function (data) {
                    alert("닉네임이 변경되었습니다.");
                    $('#nicknameUpdate').val("");
                    $('#nicknameUpdateForm').removeClass('was-validated');
                    $('#nicknameUpdate').removeClass("is-valid");
                    nicknameCheck = false;
                    location.reload();

                }, error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            });
        }

    }

    $('#searchModal').on('show.bs.modal', function (e) {
        search_modal_type = $(e.relatedTarget).attr('data-type');
    });

    function getServerName(serverId) {
        switch (serverId) {
            case "cain":
                return "카인";
                break;
            case "diregie":
                return "디레지에";
                break;
            case "siroco":
                return "시로코";
                break;
            case "prey":
                return "프레이";
                break;
            case "casillas":
                return "카시야스";
                break;
            case "hilder":
                return "힐더";
                break;
            case "anton":
                return "안톤";
                break;
            case "bakal":
                return "바칼";
                break;
        }
    }

    function searchCharacter() {
        const characterName = $('#characterName').val();
        const serverId = $('#serverId').val();
        $.ajax({
            url: "/users/characters/",
            data: {
                characterName: characterName,
                serverId: serverId,
                page : 0
            },
            type: "GET",
            success: function (data) {
                if (data == null) {
                    alert("캐릭터를 찾을 수 없습니다.");
                    return;
                } else {
                    setSearchModalResult(data);
                }
            }, error: function (request, status, error) {
            }
        });
    }

    function searchCharacterForAddAdventure() {
        const characterName = $('#characterNameAdventure').val();
        const serverId = $('#serverIdAdventure').val();
        $.ajax({
            url: "/users/characters/",
            data: {
                characterName: characterName,
                serverId: serverId,
                page : 0
            },
            type: "GET",
            success: function (data) {
                if (data == null) {
                    alert("캐릭터를 찾을 수 없습니다.");
                    return;
                } else {
                    setSearchModalResultForAddAdventure(data);
                }
            }, error: function (request, status, error) {
            }
        });
    }

    function setSearchModalResultForAddAdventure(list) {
        let html = "";
        if (list.length > 0) {
            html = '<table class="table table-striped table-hover" style="text-align: center;">';
            html += '<thead style="font-weight: bold;"><tr><td>서버</td><td>닉네임</td>';
            if (list[0].level != undefined) {
                html += '<td>레벨</td>';
            }
            html += '<td>직업</td></tr></thead>';
            html += '<tbody>';
            for (var i = 0; i < list.length; i++) {
                html += ' <tr class="search-item" data-server="' + list[i].serverId + '" data-id="' + list[i].characterId + '" data-name="' + list[i].characterName + '" onclick="setCharacterForAdventure(  \'' + list[i].serverId + '\', \'' + list[i].characterId + '\' ,\'' + list[i].characterName + '\', \'' + list[i].adventureName + '\')">';
                html += '<td>' + getServerName(list[i].serverId) + "</td>";
                html += '<td>' + list[i].characterName + "</td>";
                if (list[i].level != undefined) {
                    html += '<td>' + list[i].level + "</td>";
                }
                html += '<td>' + list[i].jobGrowName + "</td>";
                html += '</tr>';
            }
            html += '</tbody>';
            html += "</table>";
            $('#searchBodyForAdventure').html(html);
        } else {
            html = '<h3 style="text-align: center;">검색 결과가 없습니다.</h3>';
            $('#searchBodyForAdventure').html(html);
        }
    }




    function setSearchModalResult(list) {
        let html = "";
        if (list.length > 0) {
            html = '<table class="table table-striped table-hover" style="text-align: center;">';
            html += '<thead style="font-weight: bold;"><tr><td>서버</td><td>닉네임</td>';
            if (list[0].level != undefined) {
                html += '<td>레벨</td>';
            }
            html += '<td>직업</td></tr></thead>';
            html += '<tbody>';
            for (var i = 0; i < list.length; i++) {
                html += ' <tr class="search-item" data-server="' + list[i].serverId + '" data-id="' + list[i].characterId + '" data-name="' + list[i].characterName + '" onclick="setCharacter( \'' + list[i].serverId + '\', \'' + list[i].characterId + '\')">';
                html += '<td>' + getServerName(list[i].serverId) + "</td>";
                html += '<td>' + list[i].characterName + "</td>";
                if (list[i].level != undefined) {
                    html += '<td>' + list[i].level + "</td>";
                }
                html += '<td>' + list[i].jobGrowName + "</td>";
                html += '</tr>';
            }
            html += '</tbody>';
            html += "</table>";
            $('#searchBody').html(html);
        } else {
            html = '<h3 style="text-align: center;">검색 결과가 없습니다.</h3>';
            $('#searchBody').html(html);
        }
    }

    function setCharacter(serverId, characterId) {

        if (confirm("캐릭터를 추가하시겠습니까?")) {
            $.ajax({
                url: "/users/characters",
                data: {
                    serverId: serverId,
                    characterId: characterId
                },
                type: "POST",
                success: function (data) {
                    alert("캐릭터가 추가되었습니다.");
                    $('#searchModal').modal('hide');
                    location.reload();
                }, error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            });
        }
    }

    function setCharacterForAdventure(serverId, characterId,characterName,adventureName) {
        if(adventureName===null){alert('해당 캐릭터가 100레벨 이상이 아닙니다. 다시 시도해주세요.')
            $('#charSearchModalForAdventure').modal('hide');
            return;
        }
        if (confirm(adventureName+"모험단의 "+characterName+"캐릭터를 대표 캐릭터로 등록하시겠습니까? 인증 절차가 필요합니다.")) {
            $.ajax({
                url: "/users/adventure/validate",
                type: "GET",
                success: function (data) {
                    html = '<h3 style="text-align: center;">'+adventureName+' 모험단</h3>';
                    html += '<h3 style="text-align: center;">'+characterName+' 캐릭터가 등록된 서버에</h3>';
                    html += '<h3 style="text-align: center;">'+data.randomJobName+' 직업으로</h3>';
                    html += '<h3 style="text-align: center;">'+data.randomString+' 닉네임을 가진 캐릭터를 생성 후 확인을 눌러주세요. </h3>';
                    html += '<h3 style="text-align: center;">인증이 완료되면 대표 캐릭터로 등록됩니다.</h3>';
                    html += '<h3 style="text-align: center;">인증이 완료되지 않으면 대표 캐릭터로 등록되지 않습니다.</h3>';
                    html += '<button type="button" class="btn btn-primary" onclick="validateCharacterForAdventure(\''+serverId+'\',\''+characterId+'\',\''+adventureName+'\',\''+data.randomJobName+'\',\''+data.randomString+'\')">확인</button>';
                    $('#searchBodyForAdventure').html(html);
                }, error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            });
        }
    }

    function validateCharacterForAdventure(serverId, characterId,adventureName,randomJobName,randomString) {
        const data = {
            serverId: serverId,
            representCharacterId: characterId,
            adventureName: adventureName,
            randomJobName: randomJobName,
            randomString: randomString
        };
        $.ajax({
            url: "/users/adventure",
            data: JSON.stringify(data),
            contentType: "application/json; charset=utf-8",
            type: "POST",
            success: function (data) {
                    alert("모험단이 등록되었습니다.");
                    $('#charSearchModalForAdventure').modal('hide');
                    location.reload();
            }, error: function (request, status, error) {
                alert("인증에 실패하였습니다. 다시 시도해주세요.");
                $('#charSearchModalForAdventure').modal('hide');
                location.reload();            }
        });
    }

    let logPage = 0;
    let logSortBy = ";"

    function getUserLogs(page) {
        if (logPage !== 0 && page === -1 && page !== null) {
            logPage--;
        } else if (page != null && page === 1) {
            logPage++;
        } else if (page === null) {
            logPage = 0;
        }
        $.ajax({
            url: "/users/logs/",
            type: "GET",
            data: {
                page: logPage,
                type: "log",
            },
            success: function (data) {
                console.log(page);
                const next = document.getElementById('nextUserLogBtn');
                const prev = document.getElementById('prevUserLogBtn');
                next.disabled = false;
                prev.disabled = false;
                $('#notification').html("");
                let html = "";
                if (data.content.length > 0) {
                    $(data.content).each(function () {
                        html += '<div data-id="' + this.id + '" style="margin:5px">';
                        html += '<a style="text-decoration-line: none; color: #535353;" href="/boards/' + this.boardId + '">';
                        html += '<span class="boardTitle">'+this.logContent+'</span>'
                        html += '<span style="color:grey; font-size: 11px; float:right; display:inline-flex;" >' + this.createdDate + '</span>';
                        html += '</a>';
                        html += '</div>';
                        html += '</div>';
                        html += ' <div class="bar" style="width: 100%; height: 2px; background-color: #e6e6e6;"></div>';
                    });
                    $('#notification').html(html);
                } else {
                    html = '<h3 style="text-align: center;">알림이 존재하지 않습니다.</h3>';
                    $('#notification').html(html);
                }
                if (data.last === true) {
                    next.disabled = true;
                    $('#nextUserLogBtn').addClass('text-secondary');
                    $('#nextUserLogsBtn').removeClass('text-primary');
                } else {
                    next.disabled = false;
                    $('#nextUserLogBtn').removeClass('text-secondary');
                }
                if (data.number === 0) {
                    prev.disabled = true;
                    $('#prevUserLogsBtn').addClass('text-secondary');
                } else {
                    prev.disabled = false;
                    $('#prevUserLogBtn').removeClass('text-secondary');
                    $('#nextUserLogBtn').removeClass('text-secondary');
                    next.disabled = false;
                }
                $('#userLogPage').text(logPage + 1);
            }, error: function (request, status, error) {
                console.log("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);

            }
        });
    }


    function getUserCommentLogs(page) {
        if (commentPage !== 0 && page === -1 && page !== null) {
            commentPage--;
        } else if (page != null && page === 1) {
            commentPage++;
        } else if (page === null) {
            commentPage = 0;
        }
        if (page === 'like') {
            commentPage = 0;
            commentSortBy = "like";
            $('#sortByComment').text(" 좋아요순");
            $('#sortByComment').removeClass('fa fa-calendar-o');
            $('#sortByComment').addClass('fa fa-heart-o');
        } else if (page === 'date') {
            commentPage = 0;
            commentSortBy = "";
            $('#sortByComment').text(" 최신순");
            $('#sortByComment').removeClass('fa fa-heart-o');
            $('#sortByComment').addClass('fa fa-calendar-o');
        }
        $.ajax({
            url: "/users/logs/",
            type: "GET",
            data: {
                page: commentPage,
                type: "comment",
                sortBy: commentSortBy
            },
            success: function (data) {
                console.log(page);
                const next = document.getElementById('nextCommentsBtn');
                const prev = document.getElementById('prevCommentsBtn');
                next.disabled = false;
                prev.disabled = false;
                $('#commentLog').html("");
                let html = "";
                if (data.content.length > 0) {
                    $(data.content).each(function () {
                        if (this.deleted === false) {
                            html += '<div data-id="' + this.id + '" style="margin:5px">';
                            html += '<a style="text-decoration-line: none; color: #535353;" href="/boards/' + this.boardId + '">';
                            if (this.commentContent.length < 35) {
                                html += '<span class="boardTitle">' + this.commentContent + '</span>'
                            } else {
                                html += '<span class="commentOverflow" > ' + this.commentContent + '</span>'
                            }
                            html +=
                                '                                   <div style="display:inline-block; float:right;">' +
                                '                                       <i class="fa fa-heart-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.commentLikeCount + '</span>' +
                                '                                       <i class="fa fa-comments-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.childrenCommentsSize + '</span>'
                            html += '<span style="color:grey; font-size: 11px;" >' + this.createdAt + '</span>';
                            html += '</a>';
                            html += '</div>';
                            html += '</div>';
                            html += ' <div class="bar" style="width: 100%; height: 2px; background-color: #e6e6e6;"></div>';
                        } else {
                            html += '<div data-id="' + this.id + '" style="margin:5px">';
                            html += '<i class="fa fa-exclamation" aria-hidden="true" style="color:darkred"></i>';
                            if (this.commentContent.length < 35) {
                                html += '<span class="boardTitle" style="color:darkred">' + this.commentContent + '</span>'
                            } else {
                                html += '<span class="commentOverflow"  style="color:darkred"> ' + this.commentContent + '</span>'
                            }
                            html +=
                                '                                   <div style="display:inline-block; float:right;">' +
                                '                                       <i class="fa fa-heart-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.commentLikeCount + '</span>' +
                                '                                       <i class="fa fa-comments-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.childrenCommentsSize + '</span>'
                            html += '<span style="color:grey; font-size: 11px;" >' + this.createdAt + '</span>';
                            html += '</div>';
                            html += '</div>';
                            html += ' <div class="bar" style="width: 100%; height: 2px; background-color: #e6e6e6;"></div>';
                        }
                    });
                    $('#commentLog').html(html);
                } else {
                    html = '<h3 style="text-align: center;">댓글이 존재하지 않습니다.</h3>';
                    $('#commentLog').html(html);
                }
                if (data.last === true) {
                    next.disabled = true;
                    $('#nextCommentsBtn').addClass('text-secondary');
                    $('#nextCommentsBtn').removeClass('text-primary');
                } else {
                    next.disabled = false;
                    $('#nextCommentsBtn').removeClass('text-secondary');
                }
                if (data.number === 0) {
                    prev.disabled = true;
                    $('#prevCommentsBtn').addClass('text-secondary');
                } else {
                    prev.disabled = false;
                    $('#prevCommentsBtn').removeClass('text-secondary');
                    $('#nextCommentsBtn').removeClass('text-secondary');
                    next.disabled = false;
                }
                $('#commentPage').text(commentPage + 1);
            }, error: function (request, status, error) {
                console.log("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);

            }
        });
    }

    let boardPage = 0;
    let commentPage = 0;
    let boardSortBy = "";
    let commentSortBy = "";

    function getUserBoardLogs(page) {
        if (boardPage !== 0 && page === -1 && page !== null) {
            boardPage = boardPage - 1;
        } else if (page != null && page === 1) {
            boardPage = boardPage + 1;
        } else if (page === null) {
            boardPage = 0;
        }
        if (page === 'like') {
            boardSortBy = "like";
            boardPage = 0;
            $('#sortByBoard').text(' 좋아요');
            $('#sortByBoard').removeClass('fa fa-calendar-o');
            $('#sortByBoard').removeClass('fa fa-eye');
            $('#sortByBoard').removeClass('fa fa-comments-o');
            $('#sortByBoard').addClass('fa fa-heart-o');

        } else if (page === 'commentCount') {
            boardSortBy = "commentCount";
            boardPage = 0;
            $('#sortByBoard').text(' 코멘트순');
            $('#sortByBoard').removeClass('fa fa-calendar-o');
            $('#sortByBoard').removeClass('fa fa-eye');
            $('#sortByBoard').removeClass('fa fa-heart-o');
            $('#sortByBoard').addClass('fa fa-comments-o');

        } else if (page === 'view') {
            boardSortBy = "view";
            boardPage = 0;
            $('#sortByBoard').text(' 조회수순');
            $('#sortByBoard').removeClass('fa fa-calendar-o');
            $('#sortByBoard').removeClass('fa fa-heart-o');
            $('#sortByBoard').removeClass('fa fa-comments-o');
            $('#sortByBoard').addClass('fa fa-eye');
        } else if (page === 'date') {
            boardSortBy = "";
            boardPage = 0;
            $('#sortByBoard').text(' 최신순');
            $('#sortByBoard').removeClass('fa fa-heart-o');
            $('#sortByBoard').removeClass('fa fa-eye');
            $('#sortByBoard').removeClass('fa fa-comments-o');
            $('#sortByBoard').addClass('fa fa-calendar-o');
        }
        $.ajax({
            url: "/users/logs/",
            type: "GET",
            data: {
                page: boardPage,
                type: "board",
                sortBy: boardSortBy
            },
            success: function (data) {
                const next = document.getElementById('nextBoardsBtn');
                const prev = document.getElementById('prevBoardssBtn');
                next.disabled = false;
                prev.disabled = false;
                let html = "";
                $('#boardLogs').html("");
                if (data.content.length > 0) {
                    $(data.content).each(function () {
                        if (this.deleted === false) {
                            html += '<div data-id="' + this.id + '" style="margin:5px">';
                            html += '<a style="text-decoration-line: none; color: #535353;" href="/boards/' + this.id +'">';
                            if (this.character != null) {
                                html += '<div class="myPage-character">'
                                html += '<img class="text-dark ' + this.character.imgStyleClassName + '"  src="' + this.character.characterImageUrl + '"/></div>';
                                html += '<i class="fa fa-plug" style="margin-left:2px"> </i>';
                                html += '<span class="badge bg-transparent text-dark" >' + this.character.characterName + '</span>';
                            } else {
                                html += '<div class="myPage-character">';
                                html += '</div>';
                                html += '<i class="fa fa-plug" style="color: black; margin-left:2px"> </i>';
                                html += '<span class="badge bg-transparent text-dark" >캐릭터없음</span>';
                            }
                            if (this.boardTitle.length < 25) {
                                html += '<span class="boardTitle">' + this.boardTitle + '</span>';
                            } else {
                                html += '<span class="boardTitleOverflow" > ' + this.boardTitle + '</span>';
                            }
                            html +=
                                '                                   <div style="display:inline-block; float:right;">' +
                                '                                       <i class="fa fa-heart-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.boardLikeCount + '</span>' +
                                '                                       <i class="fa fa-comment-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.commentCount + '</span>'
                            html += '<span style="color:grey; font-size: 11px;" >' + this.createdAt + '</span>';
                            html += '</a>';
                            html += '</div>';
                            html += '</div>';
                            html += ' <div class="bar" style="width: 100%; height: 2px; background-color: #e6e6e6;"></div>';
                        } else {
                            html += '<div data-id="' + this.id + '" style="margin:5px">';
                            if (this.character != null) {
                                html += '<div class="myPage-character">'
                                html += '<img class="text-dark ' + this.character.imgStyleClassName + '"  src="' + this.character.characterImageUrl + '"/></div>';
                                html += '<i class="fa fa-exclamation" style="margin-left:2px; color:darkred"> </i>';
                                html += '<span class="badge bg-transparent"  style="color:darkred">삭제됨</span>';
                            } else {
                                html += '<div class="myPage-character">';
                                html += '</div>';
                                html += '<i class="fa fa-exclamation" style="color: darkred; margin-left:2px"> </i>';
                                html += '<span class="badge bg-transparent" style="color:darkred" >삭제됨</span>';
                            }
                            if (this.boardTitle.length < 25) {
                                html += '<span class="boardTitle" style="color:darkred">' + this.boardTitle + '</span>';
                            } else {
                                html += '<span class="boardTitleOverflow" style="color:darkred" > ' + this.boardTitle + '</span>';
                            }
                            html +=
                                '                                   <div style="display:inline-block; float:right;">' +
                                '                                       <i class="fa fa-heart-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.boardLikeCount + '</span>' +
                                '                                       <i class="fa fa-comment-o" style=""> </i>' +
                                '                                       <span class="badge bg-transparent text-black"' +
                                '                                             >' + this.commentCount + '</span>'
                            html += '<span style="color:grey; font-size: 11px;" >' + this.createdAt + '</span>';
                            html += '</div>';
                            html += '</div>';
                            html += ' <div class="bar" style="width: 100%; height: 2px; background-color: #e6e6e6;"></div>';
                        }
                    });

                    $('#boardLog').html(html);
                } else {
                    html = '<h3 style="text-align: center;">게시글이 존재하지 않습니다.</h3>';
                    $('#boardLog').html(html);
                }
                if (data.last === true) {
                    next.disabled = true;
                    $('#nextBoardsBtn').addClass('disabled text-secondary');
                } else {
                    next.disabled = false;
                    $('#nextBoardsBtn').removeClass('disabled text-secondary');
                }
                if (data.number === 0) {
                    prev.disabled = true;
                    $('#prevBoardssBtn').addClass('disabled text-secondary');
                } else {
                    prev.disabled = false;
                    $('#prevBoardssBtn').removeClass('disabled text-secondary');
                    $('#nextBoardsBtn').removeClass('disabled text-secondary');
                    next.disabled = false;

                }
                $('#boardPage').text(boardPage + 1);
            }, error: function (request, status, error) {
                console.log("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
            }, done: function (data) {

            }
        });
    }


    function deleteCharacter(serverId, characterId) {
        if (confirm("캐릭터를 삭제하시겠습니까?")) {
            $.ajax({
                url: "/users/characters",
                data : {
                    serverId : serverId,
                    characterId : characterId
                },
                type: "DELETE",
                success: function (data) {
                    alert("캐릭터가 삭제되었습니다.");
                    location.reload();
                }, error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            });
        }
    }

    $(document).ready(function () {
        $('#charServerId').change(function () {
            const serverId = $(this).val();
            $('#charServerId').val(getServerName(serverId));
        });
    })

    function pic() {
        var bgm = ['/images/icon_char/bg_char.jpeg', '/images/icon_char/bg_char_02.png', '/images/icon_char/bg_char_03.png'];
        $('.characterCard').css({
            'background': 'url(' + bgm[Math.floor(Math.random() * bgm.length)] + ') no-repeat',
            'background-position': 'center',
            'background-size': 'cover'
        });
    }

    pic();
    $(function () {
        $('#characterName').keypress(function (e) {
            if (e.keyCode == 13) {
                searchCharacter();

            }
        });


    });

    function logoutAlert() {
        $.ajax({
            url: "/users/logout",
            type: "POST",
            success: function (data) {
                console.log(data);
                alert("로그아웃 되었습니다.");
                location.reload();
            }
        });
    }
</script>
</html>